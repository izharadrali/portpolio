  - name: Setup Node.js
    uses: actions/setup-node@v4
    with:
      node-version: '20' # Updated to Node 20 (recommended for current use)

  - name: Install dependencies
    run: npm ci

  - name: Build
    env:
      # Firebase env vars (set as repository secrets)
      VITE_FIREBASE_API_KEY: ${{ secrets.VITE_FIREBASE_API_KEY }}
      VITE_FIREBASE_AUTH_DOMAIN: ${{ secrets.VITE_FIREBASE_AUTH_DOMAIN }}
      VITE_FIREBASE_PROJECT_ID: ${{ secrets.VITE_FIREBASE_PROJECT_ID }}
      VITE_FIREBASE_STORAGE_BUCKET: ${{ secrets.VITE_FIREBASE_STORAGE_BUCKET }}
      VITE_FIREBASE_MESSAGING_SENDER_ID: ${{ secrets.VITE_FIREBASE_MESSAGING_SENDER_ID }}
      VITE_FIREBASE_APP_ID: ${{ secrets.VITE_FIREBASE_APP_ID }}
      # Optional EmailJS env vars
      VITE_EMAILJS_SERVICE_ID: ${{ secrets.VITE_EMAILJS_SERVICE_ID }}
      VITE_EMAILJS_TEMPLATE_ID: ${{ secrets.VITE_EMAILJS_TEMPLATE_ID }}
      VITE_EMAILJS_PUBLIC_KEY: ${{ secrets.VITE_EMAILJS_PUBLIC_KEY }}
    run: npm run build

  - name: Configure GitHub Pages
    uses: actions/configure-pages@v4 # <<< UPDATED TO V4

  - name: Upload artifact
    uses: actions/upload-pages-artifact@v4 # <<< UPDATED TO V4
    with:
      path: ./dist
